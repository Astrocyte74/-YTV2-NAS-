# Data Directory

Runtime artifacts generated by the NAS pipeline. This folder is ignored by Git except for this README.

- `reports/` – JSON reports produced after each video is processed. Optional/local debugging/backfill only; dashboard reads Postgres.
- `transcripts/` – Cached transcript payloads for debugging and reprocessing.
- `backups/` – Any ad-hoc database or report snapshots kept for disaster recovery.
- `logs/` – Historical maintenance logs (backfill, cleanup, metadata fixes). New logs should land here automatically.
- `ledger.json`, `ytv2_content.db` – Local runtime state; both are ignored from version control.

Old SQLite migration artefacts have been removed (e.g., `process_locks.db`, `reports_pre_repalced/`).

## Summary Image Reset
- Delete NAS images: `docker exec -i youtube-summarizer-bot rm -rf /app/data/exports/images/*`
- Clear summary image metadata in Postgres:
  ```bash
  docker exec -i youtube-summarizer-bot python3 -c "import os, psycopg\nurl = os.getenv('DATABASE_URL_POSTGRES_NEW') or os.getenv('DATABASE_URL')\nassert url, 'missing DB URL'\nreset_sql = '''\nUPDATE content\n   SET summary_image_url = NULL,\n       analysis_json = COALESCE(analysis_json, '{}'::jsonb)\n                        - 'summary_image_prompt'\n                        - 'summary_image_prompt_last_used'\n                        - 'summary_image_selected_url'\n                        || jsonb_build_object('summary_image_variants', '[]'::jsonb)\n'''\nwith psycopg.connect(url) as conn:\n    with conn.cursor() as cur:\n        cur.execute(reset_sql)\n        conn.commit()\n"
  ```
- Re-run backfill: `docker exec -i youtube-summarizer-bot python3 /app/tools/backfill_summary_images.py --limit 10`

